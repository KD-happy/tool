<!DOCTYPE html>
<html lang="zh-cn">
<head>
    <meta charset="UTF-8">
    <meta name="referrer" content="no-referrer">
    <meta http-equiv="X-UA-Compatible" content="IE=edge">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <script src="https://lib.baomitu.com/limonte-sweetalert2/7.33.1/sweetalert2.all.min.js"></script>
    <script src="https://cdn.staticfile.org/jquery/1.10.2/jquery.min.js"></script>
    <script src="https://cdn.staticfile.org/jquery-cookie/1.4.1/jquery.cookie.min.js"></script>
    <script src="https://lib.baomitu.com/crypto-js/3.3.0/crypto-js.min.js"></script>
    <script src="https://cdn.bootcdn.net/ajax/libs/hls.js/1.2.0/hls.min.js"></script>
    <script src="https://cdnjs.cloudflare.com/ajax/libs/dplayer/1.26.0/DPlayer.min.js"></script>
    <link rel="stylesheet" href="./fi11.css">
    <title>JULIA</title>
</head>
<body>
    <div class="videoListBox"></div>
    <div id="button">
        <button id="add_token">添加token</button>
        <button id="login">登录</button>
        <button id="continue">继续播放</button>
        <button id="add">添加</button>
        <button id="home">首页</button>
    </div>
    <div id="player">
        <button id="close">关闭</button>
        <div id="dplayer"></div>
    </div>
    <script src="./fi11.js"></script>
    <script src="./actor_add.js"></script>
    <script>
        var search = Object.fromEntries(new URLSearchParams(location.search))
        var actorId
        actorId =  search.actorId != null ? search.actorId : 2
        get_title(actorId)
        var dp = null;
        var fi11_auth = $.cookie('fi11_auth')
        if (!fi11_auth) {
            Toast.fire({
                icon: 'error',
                text: 'fi11_auth 为空！！请登录！！'
            })
            $("#login").show()
            $("#add_token").show()
        } else {
            console.log(fi11_auth)
            $("#login").hide()
            $("#add_token").hide()
        }
        var page = 1
        add_item(page)
        $(window).keydown(function(event) {
            let _key = !event.altKey && !event.shiftKey && !event.ctrlKey
            if (event.which == 27) {
                if ($("#player").is(':visible')) {
                    $("#close").click()
                }
            } else if (event.key == 'w' && _key && $("#player").is(':visible')) {
                let full = document.querySelector(".dplayer-full-in-icon")
                full && full.click()
            } else if (event.key == 'f' && _key && $("#player").is(':visible')) {
                let full = document.querySelector(".dplayer-full-icon")
                full && full.click()
            }
        })
        $('#player').hide()
        $('#continue').hide()
        $('#player').attr("disabled", true)
        $("#close").click(function() {
            $("body").css("overflow", "")
            $("#player").hide()
            $("#continue").show()
            dp.pause()
        })
        $("#add").click(function() {
            page++
            add_item(page)
            Toast.fire({
                icon: 'success',
                text: `添加第${page}页成功！！`
            })
        })
        $("#login").click(function() {
            let userName = prompt("请输入邮箱：", "wlhs@163.com")
            if (userName) {
                let password = prompt("请输入密码：", "wlhs163com")
                if (password) {
                    user_login(userName, password)
                } else {
                    Toast.fire({
                        icon: 'error',
                        text: '取消登录'
                    })
                }
            } else {
                Toast.fire({
                    icon: 'error',
                    text: '取消登录'
                })
            }
        })
        $("#continue").click(function() {
            $("body").css("overflow", "hidden")
            $("#player").show()
            $("#continue").hide()
        })
        $("#home").click(function() {
            location.href = "./"
        })
        $("#add_token").click(function() {
            let tmp_token = prompt("请输入token：")
            fi11_auth = tmp_token
            if (tmp_token) {
                Toast.fire({
                    icon: 'success',
                    text: '添加成功'
                })
                $.cookie('fi11_auth', tmp_token, {expires: 1})
                $("#login").hide()
                $("#add_token").hide()
            } else {
                Toast.fire({
                    icon: 'error',
                    text: '取消添加'
                })
            }
        })
    </script>
</body>
</html>